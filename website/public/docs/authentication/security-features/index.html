<!DOCTYPE html>
<html lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<title>Security Features | AI Code Terminal: The AI-Native Shell</title>
<meta name="description" content="Comprehensive security measures including encryption, input validation, and access control">
<meta name="keywords" content="AI development, Claude Code, self-hosted terminal, development environment, AI coding, browser terminal, Docker deployment">
<meta name="author" content="AI Code Terminal">
<meta name="robots" content="index, follow">
<link rel="canonical" href="http://localhost:1313/docs/authentication/security-features/">


<meta property="og:type" content="article">
<meta property="og:title" content="Security Features | AI Code Terminal: The AI-Native Shell">
<meta property="og:description" content="Comprehensive security measures including encryption, input validation, and access control">
<meta property="og:url" content="http://localhost:1313/docs/authentication/security-features/">
<meta property="og:site_name" content="AI Code Terminal: The AI-Native Shell">
<meta property="og:image" content="http://localhost:1313/images/claude_code_in_action.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="AI Code Terminal - Browser-based development environment with Claude integration">


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Security Features | AI Code Terminal: The AI-Native Shell">
<meta name="twitter:description" content="Comprehensive security measures including encryption, input validation, and access control">
<meta name="twitter:image" content="http://localhost:1313/images/claude_code_in_action.png">
<meta name="twitter:image:alt" content="AI Code Terminal - Browser-based development environment with Claude integration">


<link rel="icon" type="image/svg+xml" href="/terminal-icon.svg">
<link rel="icon" type="image/png" href="/favicon.png" sizes="32x32">
<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">


<meta name="theme-color" content="#010411">
<meta name="msapplication-TileColor" content="#010411">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500&family=Space+Grotesk:wght@400;500;700&display=swap" rel="stylesheet">


<script src="https://unpkg.com/feather-icons"></script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "AI Code Terminal: The AI-Native Shell",
  "description": "A self-hosted development environment for the post-IDE era. Code from any device with a fast, lightweight, AI-native shell.",
  "url": "http:\/\/localhost:1313\/",
  "applicationCategory": "DeveloperApplication",
  "operatingSystem": "Linux, macOS, Windows",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "author": {
    "@type": "Organization",
    "name": "AI Code Terminal"
  }
}
</script>


<link rel="stylesheet" href="/css/shared.css">

    <link rel="stylesheet" href="/css/docs.css">

</head>
<body class="docs-site">
    
    
    <header>
    <div class="container">
        <nav>
            <a href="http://localhost:1313/" class="logo">
                <span class="prompt-char">&gt;</span> AI Code Terminal
            </a>
            <div class="nav-links">
                <a href="/docs/getting-started/introduction/" class="nav-link">
                    <i data-feather="book"></i>
                    <span>Documentation</span>
                </a>
                <a href="/getting-started/" class="nav-link">
                    <i data-feather="book-open"></i>
                    <span>Getting Started</span>
                </a>
                <a href="https://github.com/drmhse/ai-code-terminal" target="_blank" rel="noopener noreferrer" class="nav-link">
                    <i data-feather="github"></i>
                    <span>View on GitHub</span>
                </a>
            </div>
        </nav>
    </div>
</header>

    <main>
        

<div class="min-h-screen bg-[#010411] text-[#d4dff3]">
  
  
  <button id="mobile-sidebar-toggle" class="lg:hidden fixed top-4 left-4 z-50 p-3 bg-[#0a0c1a] border border-[rgba(67,79,138,0.2)] rounded-lg">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
  </button>

  
  <div id="mobile-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30 hidden"></div>

  <div class="flex pt-20"> 
    
    
    <aside id="docs-sidebar" class="fixed lg:relative w-80 bg-[rgba(1,4,17,0.95)] border-r border-[rgba(67,79,138,0.2)] h-screen lg:h-[calc(100vh-5rem)] overflow-y-auto backdrop-blur-xl z-40 -translate-x-full lg:translate-x-0 transition-transform duration-300">
      
      
      <div class="sticky top-0 bg-[rgba(1,4,17,0.9)] backdrop-blur-sm border-b border-[rgba(67,79,138,0.2)] p-6">
        <div class="flex items-center space-x-3 mb-6">
          <div class="w-8 h-8 bg-[#82aaff] rounded-lg flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
            </svg>
          </div>
          <h3 class="text-lg font-semibold text-[#d4dff3]">Documentation</h3>
        </div>
        
        
        <div class="relative">
          <svg class="absolute left-3 top-3.5 w-4 h-4 text-[#8b9cc2]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          <input type="text" placeholder="Search docs..." class="w-full pl-10 pr-4 py-3 bg-[rgba(10,12,26,0.6)] border border-[rgba(67,79,138,0.2)] rounded-lg text-[#d4dff3] placeholder-[#8b9cc2] focus:outline-none focus:border-[#82aaff] focus:ring-1 focus:ring-[#82aaff] transition-colors">
        </div>
      </div>

      
      <nav class="p-4 space-y-2">
        
        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="getting-started">
            <span class="uppercase tracking-wider">Getting Started</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/getting-started/introduction/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Introduction
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/getting-started/quick-start/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Quick Start
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/getting-started/installation/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Installation
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/getting-started/github-oauth/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                GitHub OAuth Setup
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/getting-started/configuration/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Configuration
              </a>
            </li>
            
            
          </ul>
        </div>

        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="core-features">
            <span class="uppercase tracking-wider">Core Features</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/core-features/terminal-access/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Terminal Access
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/core-features/workspace-management/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Workspace Management
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/core-features/github-integration/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                GitHub Integration
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/core-features/claude-integration/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Claude Integration
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/core-features/real-time-features/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Real-time Features
              </a>
            </li>
            
            
          </ul>
        </div>

        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="authentication">
            <span class="uppercase tracking-wider">Authentication</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/authentication/auth-flow/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Authentication Flow
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/authentication/security-features/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors active bg-[rgba(130,170,255,0.1)] !text-[#82aaff] font-medium">
                Security Features
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/authentication/token-management/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Token Management
              </a>
            </li>
            
            
          </ul>
        </div>

        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="api">
            <span class="uppercase tracking-wider">API & WebSocket</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/api/endpoints/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                API Endpoints
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/api/websocket/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                WebSocket Events
              </a>
            </li>
            
            
          </ul>
        </div>

        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="database">
            <span class="uppercase tracking-wider">Database</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/database/schema/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Database Schema
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/database/models/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Data Models
              </a>
            </li>
            
            
          </ul>
        </div>

        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="development">
            <span class="uppercase tracking-wider">Development</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/development/setup/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Development Setup
              </a>
            </li>
            
            <li>
              <a href="http://localhost:1313/docs/development/testing/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Testing
              </a>
            </li>
            
            
          </ul>
        </div>

        
        <div class="nav-section">
          <button class="nav-section-toggle flex items-center justify-between w-full px-3 py-2 text-sm font-medium text-[#82aaff] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors" data-section="deployment">
            <span class="uppercase tracking-wider">Deployment</span>
            <svg class="w-4 h-4 transform transition-transform chevron" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
          <ul class="nav-section-content mt-1 space-y-1 max-h-0 overflow-hidden transition-all duration-300 ease-in-out">
            
            
            <li>
              <a href="http://localhost:1313/docs/deployment/docker/" class="nav-link block py-2 px-6 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded-lg transition-colors ">
                Docker Deployment
              </a>
            </li>
            
            
          </ul>
        </div>

      </nav>
    </aside>

    
    <main class="flex-1 lg:ml-80">
      
      
      <div class="sticky top-20 bg-[rgba(1,4,17,0.9)] backdrop-blur-sm border-b border-[rgba(67,79,138,0.2)] px-8 py-4 z-10">
        <nav class="flex items-center space-x-2 text-sm">
          <a href="/" class="text-[#8b9cc2] hover:text-[#d4dff3] transition-colors">Home</a>
          <svg class="w-4 h-4 text-[#8b9cc2]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
          <a href="/docs" class="text-[#8b9cc2] hover:text-[#d4dff3] transition-colors">Documentation</a>
          
          <svg class="w-4 h-4 text-[#8b9cc2]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
          <a href="http://localhost:1313/docs/authentication/" class="text-[#8b9cc2] hover:text-[#d4dff3] transition-colors">Authentication &amp; Security</a>
          
          <svg class="w-4 h-4 text-[#8b9cc2]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
          <span class="text-[#82aaff] font-medium">Security Features</span>
        </nav>
      </div>

      <div class="flex">
        
        <article class="flex-1 px-8 py-12 max-w-4xl">
          
          
          <header class="mb-12">
            
            
            <h1 class="text-4xl lg:text-5xl font-bold text-[#d4dff3] mb-6 leading-tight">Security Features</h1>
            
            
            <p class="text-xl text-[#8b9cc2] leading-relaxed mb-8">Comprehensive security measures including encryption, input validation, and access control</p>
            
            
            
            <div class="flex items-center space-x-6 text-sm text-[#8b9cc2]">
              
              
              <div class="flex items-center space-x-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span>8 min read</span>
              </div>
              
            </div>
            
          </header>

          
          <div class="prose prose-invert prose-lg max-w-none">
            <h1 id="security-features">Security Features</h1>
<p>AI Code Terminal implements multiple layers of security to protect user data, prevent unauthorized access, and ensure safe operation in both development and production environments.</p>
<h2 id="multi-layer-security-architecture">Multi-Layer Security Architecture</h2>
<h3 id="defense-in-depth">Defense in Depth</h3>
<p>The security model implements multiple overlapping layers:</p>
<ol>
<li><strong>Network Security</strong> - HTTPS, secure headers, CORS</li>
<li><strong>Authentication Security</strong> - OAuth 2.0, JWT, single-tenant validation</li>
<li><strong>Authorization Security</strong> - Role-based access, resource permissions</li>
<li><strong>Data Security</strong> - Encryption at rest, secure transmission</li>
<li><strong>Application Security</strong> - Input validation, output sanitization</li>
<li><strong>Infrastructure Security</strong> - Container isolation, resource limits</li>
</ol>
<h2 id="encryption-and-data-protection">Encryption and Data Protection</h2>
<h3 id="data-encryption-at-rest">Data Encryption at Rest</h3>
<p>Sensitive data is encrypted using industry-standard algorithms:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// AES-256-CBC encryption for sensitive data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">encrypt</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">text</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">algorithm</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;aes-256-cbc&#39;</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">scryptSync</span>(<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">JWT_SECRET</span>, <span style="color:#e6db74">&#39;salt&#39;</span>, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">randomBytes</span>(<span style="color:#ae81ff">16</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cipher</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createCipher</span>(<span style="color:#a6e22e">algorithm</span>, <span style="color:#a6e22e">key</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cipher</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">text</span>, <span style="color:#e6db74">&#39;utf8&#39;</span>, <span style="color:#e6db74">&#39;hex&#39;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">iv</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">iv</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#e6db74">&#39;hex&#39;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">encryptedData</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cipher</span>.<span style="color:#66d9ef">final</span>(<span style="color:#e6db74">&#39;hex&#39;</span>)
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p><strong>Encrypted Data Types:</strong></p>
<ul>
<li>GitHub OAuth access tokens</li>
<li>GitHub OAuth refresh tokens</li>
<li>Sensitive configuration data</li>
<li>User session information</li>
</ul>
<h3 id="data-encryption-in-transit">Data Encryption in Transit</h3>
<p>All data transmission is secured:</p>
<ul>
<li><strong>HTTPS Enforcement</strong> - TLS 1.2+ required in production</li>
<li><strong>WebSocket Security</strong> - WSS (WebSocket Secure) for terminal I/O</li>
<li><strong>Certificate Validation</strong> - Strict certificate verification</li>
<li><strong>HSTS Headers</strong> - HTTP Strict Transport Security</li>
</ul>
<h3 id="key-management">Key Management</h3>
<p>Cryptographic keys are managed securely:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Environment-based key derivation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">deriveEncryptionKey</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secret</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">JWT_SECRET</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">secret</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;JWT_SECRET must be at least 32 characters&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">scryptSync</span>(<span style="color:#a6e22e">secret</span>, <span style="color:#e6db74">&#39;ai-code-terminal&#39;</span>, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="input-validation-and-sanitization">Input Validation and Sanitization</h2>
<h3 id="request-validation">Request Validation</h3>
<p>All API requests undergo strict validation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Input validation middleware
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">validateWorkspaceCreation</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span>(<span style="color:#e6db74">&#39;repoUrl&#39;</span>).<span style="color:#a6e22e">isURL</span>().<span style="color:#a6e22e">withMessage</span>(<span style="color:#e6db74">&#39;Valid repository URL required&#39;</span>),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span>(<span style="color:#e6db74">&#39;name&#39;</span>).<span style="color:#a6e22e">isAlphanumeric</span>().<span style="color:#a6e22e">isLength</span>({ <span style="color:#a6e22e">min</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">max</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">50</span> }),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">body</span>(<span style="color:#e6db74">&#39;description&#39;</span>).<span style="color:#a6e22e">optional</span>().<span style="color:#a6e22e">isLength</span>({ <span style="color:#a6e22e">max</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">200</span> }),
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">errors</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">validationResult</span>(<span style="color:#a6e22e">req</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">400</span>).<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">errors</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">array</span>() });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><h3 id="terminal-input-sanitization">Terminal Input Sanitization</h3>
<p>Terminal input is carefully validated:</p>
<ul>
<li><strong>Command Length Limits</strong> - Prevent buffer overflow attacks</li>
<li><strong>Character Filtering</strong> - Block dangerous control sequences</li>
<li><strong>Encoding Validation</strong> - Ensure proper UTF-8 encoding</li>
<li><strong>Size Limits</strong> - Prevent memory exhaustion</li>
</ul>
<h3 id="file-path-validation">File Path Validation</h3>
<p>File operations are restricted to safe paths:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">validateWorkspacePath</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">workspacePath</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resolvedPath</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">workspacePath</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">workspaceRoot</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">WORKSPACE_ROOT</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;./workspaces&#39;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Prevent directory traversal
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">resolvedPath</span>.<span style="color:#a6e22e">startsWith</span>(<span style="color:#a6e22e">workspaceRoot</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Path outside workspace not allowed&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">resolvedPath</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="access-control-and-authorization">Access Control and Authorization</h2>
<h3 id="single-tenant-model">Single-Tenant Model</h3>
<p>Strict single-tenant access enforcement:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// User validation middleware
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">validateTenantUser</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">allowedUsername</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">TENANT_GITHUB_USERNAME</span>;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">username</span> <span style="color:#f92672">!==</span> <span style="color:#a6e22e">allowedUsername</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">403</span>).<span style="color:#a6e22e">json</span>({ 
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">error</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Access denied: unauthorized tenant user&#39;</span> 
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="resource-level-authorization">Resource-Level Authorization</h3>
<p>Fine-grained access control for resources:</p>
<ul>
<li><strong>Workspace Ownership</strong> - Users can only access their workspaces</li>
<li><strong>Session Isolation</strong> - Terminal sessions are user-specific</li>
<li><strong>File System Boundaries</strong> - Access limited to workspace directories</li>
<li><strong>Process Isolation</strong> - Each session runs in isolated environment</li>
</ul>
<h3 id="api-endpoint-protection">API Endpoint Protection</h3>
<p>All API endpoints require proper authorization:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Protected route example
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/api/workspaces&#39;</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">authenticateToken</span>,           <span style="color:#75715e">// Verify JWT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">validateTenantUser</span>,          <span style="color:#75715e">// Verify single-tenant access
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">validateWorkspaceAccess</span>,     <span style="color:#75715e">// Verify workspace permissions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">getWorkspaces</span>               <span style="color:#75715e">// Execute request
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>);
</span></span></code></pre></div><h2 id="network-security">Network Security</h2>
<h3 id="cors-configuration">CORS Configuration</h3>
<p>Cross-Origin Resource Sharing is strictly configured:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">corsOptions</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">origin</span>, <span style="color:#a6e22e">callback</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">allowedOrigins</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">FRONTEND_URL</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#39;http://localhost:3014&#39;</span>,
</span></span><span style="display:flex;"><span>      ...(<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">ALLOWED_ORIGINS</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;,&#39;</span>) <span style="color:#f92672">||</span> [])
</span></span><span style="display:flex;"><span>    ].<span style="color:#a6e22e">filter</span>(Boolean);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">origin</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">allowedOrigins</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">origin</span>)) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">callback</span>(<span style="color:#66d9ef">null</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">callback</span>(<span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Not allowed by CORS&#39;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">optionsSuccessStatus</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="security-headers">Security Headers</h3>
<p>Comprehensive security headers are enforced:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Security headers middleware
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Prevent MIME type sniffing
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">setHeader</span>(<span style="color:#e6db74">&#39;X-Content-Type-Options&#39;</span>, <span style="color:#e6db74">&#39;nosniff&#39;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// XSS protection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">setHeader</span>(<span style="color:#e6db74">&#39;X-XSS-Protection&#39;</span>, <span style="color:#e6db74">&#39;1; mode=block&#39;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Frame options
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">setHeader</span>(<span style="color:#e6db74">&#39;X-Frame-Options&#39;</span>, <span style="color:#e6db74">&#39;DENY&#39;</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Content Security Policy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">setHeader</span>(<span style="color:#e6db74">&#39;Content-Security-Policy&#39;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;default-src &#39;self&#39;; script-src &#39;self&#39; &#39;unsafe-inline&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// HSTS (production only)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">NODE_ENV</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;production&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">setHeader</span>(<span style="color:#e6db74">&#39;Strict-Transport-Security&#39;</span>, 
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#39;max-age=31536000; includeSubDomains; preload&#39;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h3 id="rate-limiting">Rate Limiting</h3>
<p>Prevent abuse with rate limiting:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">rateLimit</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express-rate-limit&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// API rate limiting
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">apiLimiter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">rateLimit</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">windowMs</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">15</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1000</span>, <span style="color:#75715e">// 15 minutes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">max</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">100</span>, <span style="color:#75715e">// Limit each IP to 100 requests per windowMs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">error</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Too many requests from this IP&#39;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">standardHeaders</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">legacyHeaders</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#39;/api/&#39;</span>, <span style="color:#a6e22e">apiLimiter</span>);
</span></span></code></pre></div><h2 id="container-security">Container Security</h2>
<h3 id="docker-security-hardening">Docker Security Hardening</h3>
<p>The Docker container implements security best practices:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#75715e"># Run as non-root user</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> adduser --disabled-password --gecos <span style="color:#e6db74">&#39;&#39;</span> claude<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">USER</span><span style="color:#e6db74"> claude</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Read-only root filesystem</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--read-only<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># No new privileges</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--security-opt no-new-privileges:true<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Resource limits</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--memory 4g<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--cpus <span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#75715e"># Drop capabilities</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--cap-drop ALL<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--cap-add SETUID<span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>--cap-add SETGID<span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><h3 id="process-isolation">Process Isolation</h3>
<p>Each terminal session runs in isolation:</p>
<ul>
<li><strong>Separate Process Groups</strong> - Each session in own process group</li>
<li><strong>Resource Limits</strong> - Memory and CPU limits per session</li>
<li><strong>Network Isolation</strong> - Limited network access</li>
<li><strong>File System Boundaries</strong> - Restricted to workspace directories</li>
</ul>
<h3 id="security-contexts">Security Contexts</h3>
<p>Different security contexts for different operations:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Spawn terminal with restricted permissions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">spawnTerminal</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">workspacePath</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">terminal</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">spawn</span>(<span style="color:#e6db74">&#39;bash&#39;</span>, [], {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cwd</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">workspacePath</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">env</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      ...<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">PATH</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/usr/local/bin:/usr/bin:/bin&#39;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">HOME</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">workspacePath</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">USER</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;claude&#39;</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">uid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>, <span style="color:#75715e">// claude user
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">gid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>  <span style="color:#75715e">// claude group
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  });
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">terminal</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="session-security">Session Security</h2>
<h3 id="jwt-security">JWT Security</h3>
<p>JSON Web Tokens are implemented securely:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Secure JWT configuration
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">jwtOptions</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">algorithm</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;HS256&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">expiresIn</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;7d&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">issuer</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;ai-code-terminal&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">audience</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;terminal-user&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">notBefore</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">clockTolerance</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e">// 30 seconds
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// JWT validation with additional checks
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">validateJWT</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">token</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decoded</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">verify</span>(<span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">JWT_SECRET</span>, <span style="color:#a6e22e">jwtOptions</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Additional validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">decoded</span>.<span style="color:#a6e22e">iat</span> <span style="color:#f92672">&gt;</span> Date.<span style="color:#a6e22e">now</span>() <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Token issued in future&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decoded</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="session-management">Session Management</h3>
<p>Secure session handling:</p>
<ul>
<li><strong>Secure Cookies</strong> - HttpOnly, Secure, SameSite attributes</li>
<li><strong>Session Timeout</strong> - Automatic expiration</li>
<li><strong>Concurrent Session Limits</strong> - Prevent session abuse</li>
<li><strong>Session Invalidation</strong> - Clean logout and token revocation</li>
</ul>
<h2 id="vulnerability-protection">Vulnerability Protection</h2>
<h3 id="csrf-protection">CSRF Protection</h3>
<p>Cross-Site Request Forgery protection:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// CSRF token validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">csrfProtection</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ([<span style="color:#e6db74">&#39;POST&#39;</span>, <span style="color:#e6db74">&#39;PUT&#39;</span>, <span style="color:#e6db74">&#39;DELETE&#39;</span>, <span style="color:#e6db74">&#39;PATCH&#39;</span>].<span style="color:#a6e22e">includes</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">method</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">headers</span>[<span style="color:#e6db74">&#39;x-csrf-token&#39;</span>] <span style="color:#f92672">||</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">_csrf</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sessionToken</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">session</span>.<span style="color:#a6e22e">csrfToken</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">token</span> <span style="color:#f92672">||</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">sessionToken</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">token</span> <span style="color:#f92672">!==</span> <span style="color:#a6e22e">sessionToken</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">403</span>).<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">error</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Invalid CSRF token&#39;</span> });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="xss-prevention">XSS Prevention</h3>
<p>Cross-Site Scripting protection:</p>
<ul>
<li><strong>Content Security Policy</strong> - Restrict script sources</li>
<li><strong>Output Encoding</strong> - HTML entity encoding</li>
<li><strong>Input Sanitization</strong> - Remove dangerous content</li>
<li><strong>X-XSS-Protection Header</strong> - Browser XSS filtering</li>
</ul>
<h3 id="sql-injection-prevention">SQL Injection Prevention</h3>
<p>Although using SQLite, injection prevention is implemented:</p>
<ul>
<li><strong>Parameterized Queries</strong> - All database queries use parameters</li>
<li><strong>ORM Usage</strong> - Prisma provides additional protection</li>
<li><strong>Input Validation</strong> - All user input validated before database operations</li>
</ul>
<h3 id="directory-traversal-prevention">Directory Traversal Prevention</h3>
<p>Prevent path traversal attacks:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">securePath</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">userPath</span>, <span style="color:#a6e22e">basePath</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">resolved</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">basePath</span>, <span style="color:#a6e22e">userPath</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">base</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#a6e22e">basePath</span>);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Ensure resolved path is within base directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">resolved</span>.<span style="color:#a6e22e">startsWith</span>(<span style="color:#a6e22e">base</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">sep</span>) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">resolved</span> <span style="color:#f92672">!==</span> <span style="color:#a6e22e">base</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Path traversal detected&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">resolved</span>;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="monitoring-and-alerting">Monitoring and Alerting</h2>
<h3 id="security-event-logging">Security Event Logging</h3>
<p>Comprehensive logging of security events:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">securityLogger</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">createLogger</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">level</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;info&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">combine</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">timestamp</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>  ),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">defaultMeta</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">service</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;ai-code-terminal-security&#39;</span> },
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">transports</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">transports</span>.<span style="color:#a6e22e">File</span>({ <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;security.log&#39;</span> }),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">transports</span>.<span style="color:#a6e22e">Console</span>()
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Log security events
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">logSecurityEvent</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">event</span>, <span style="color:#a6e22e">details</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">securityLogger</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#39;Security Event&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">event</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">details</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">timestamp</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ip</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">details</span>.<span style="color:#a6e22e">ip</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">userAgent</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">details</span>.<span style="color:#a6e22e">userAgent</span>
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h3 id="intrusion-detection">Intrusion Detection</h3>
<p>Basic intrusion detection capabilities:</p>
<ul>
<li><strong>Failed Login Monitoring</strong> - Track failed authentication attempts</li>
<li><strong>Unusual Access Patterns</strong> - Detect abnormal usage</li>
<li><strong>Resource Usage Monitoring</strong> - Monitor for resource abuse</li>
<li><strong>Error Rate Monitoring</strong> - High error rates may indicate attacks</li>
</ul>
<h3 id="audit-trail">Audit Trail</h3>
<p>Comprehensive audit logging:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">auditLog</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">action</span>, <span style="color:#a6e22e">resource</span>, <span style="color:#a6e22e">user</span>, <span style="color:#a6e22e">details</span> <span style="color:#f92672">=</span> {}) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">auditLogger</span>.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#39;Audit Event&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">action</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">resource</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">user</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">username</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">userId</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">timestamp</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">details</span>
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="security-configuration">Security Configuration</h2>
<h3 id="environment-security">Environment Security</h3>
<p>Secure environment configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Security-focused environment variables</span>
</span></span><span style="display:flex;"><span>NODE_ENV<span style="color:#f92672">=</span>production
</span></span><span style="display:flex;"><span>HTTPS_ONLY<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>SECURE_COOKIES<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>CSRF_PROTECTION<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Strong JWT secret (production)</span>
</span></span><span style="display:flex;"><span>JWT_SECRET<span style="color:#f92672">=</span>your-cryptographically-secure-secret-at-least-32-characters
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Rate limiting</span>
</span></span><span style="display:flex;"><span>RATE_LIMIT_WINDOW_MS<span style="color:#f92672">=</span><span style="color:#ae81ff">900000</span>  <span style="color:#75715e"># 15 minutes</span>
</span></span><span style="display:flex;"><span>RATE_LIMIT_MAX_REQUESTS<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Session security</span>
</span></span><span style="display:flex;"><span>SESSION_TIMEOUT_MINUTES<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span>MAX_CONCURRENT_SESSIONS<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span></code></pre></div><h3 id="production-security-checklist">Production Security Checklist</h3>
<p>Essential security measures for production:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>HTTPS Enforced</strong> - All traffic over TLS</li>
<li><input disabled="" type="checkbox"> <strong>Strong JWT Secret</strong> - Cryptographically secure secret</li>
<li><input disabled="" type="checkbox"> <strong>Rate Limiting Enabled</strong> - API abuse protection</li>
<li><input disabled="" type="checkbox"> <strong>Security Headers Set</strong> - HSTS, CSP, etc.</li>
<li><input disabled="" type="checkbox"> <strong>Input Validation Active</strong> - All user input validated</li>
<li><input disabled="" type="checkbox"> <strong>Audit Logging Enabled</strong> - Security events logged</li>
<li><input disabled="" type="checkbox"> <strong>Container Security</strong> - Non-root user, read-only filesystem</li>
<li><input disabled="" type="checkbox"> <strong>Resource Limits Set</strong> - Memory and CPU limits</li>
<li><input disabled="" type="checkbox"> <strong>Regular Security Updates</strong> - Dependencies kept current</li>
</ul>
<h2 id="incident-response">Incident Response</h2>
<h3 id="security-incident-handling">Security Incident Handling</h3>
<p>Procedures for handling security incidents:</p>
<ol>
<li><strong>Detection</strong> - Automated monitoring and alerts</li>
<li><strong>Assessment</strong> - Evaluate scope and impact</li>
<li><strong>Containment</strong> - Limit damage and prevent spread</li>
<li><strong>Eradication</strong> - Remove threats and vulnerabilities</li>
<li><strong>Recovery</strong> - Restore normal operations</li>
<li><strong>Lessons Learned</strong> - Post-incident review and improvements</li>
</ol>
<h3 id="emergency-procedures">Emergency Procedures</h3>
<p>Emergency security procedures:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Emergency shutdown procedure
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">emergencyShutdown</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Disable new logins
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">MAINTENANCE_MODE</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;true&#39;</span>;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Terminate active sessions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">emit</span>(<span style="color:#e6db74">&#39;emergency-logout&#39;</span>, { <span style="color:#a6e22e">reason</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Security incident&#39;</span> });
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Log emergency event
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">securityLogger</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Emergency Shutdown&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">timestamp</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">toISOString</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">reason</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Security incident detected&#39;</span>
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><h2 id="compliance-and-standards">Compliance and Standards</h2>
<h3 id="security-standards">Security Standards</h3>
<p>The application follows established security standards:</p>
<ul>
<li><strong>OWASP Top 10</strong> - Protection against common vulnerabilities</li>
<li><strong>OAuth 2.0 Security Best Practices</strong> - RFC 6819 compliance</li>
<li><strong>JWT Security Best Practices</strong> - RFC 8725 recommendations</li>
<li><strong>Container Security Standards</strong> - CIS Docker Benchmark</li>
</ul>
<h3 id="regular-security-assessments">Regular Security Assessments</h3>
<p>Ongoing security measures:</p>
<ul>
<li><strong>Dependency Scanning</strong> - Regular vulnerability scans</li>
<li><strong>Code Security Reviews</strong> - Static analysis</li>
<li><strong>Penetration Testing</strong> - Regular security testing</li>
<li><strong>Security Audits</strong> - Periodic third-party audits</li>
</ul>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li><strong><a href="/docs/authentication/token-management/">Token Management</a>:</strong> Token lifecycle management</li>
<li><strong><a href="/docs/api/endpoints/">API Endpoints</a>:</strong> API security requirements</li>
<li><strong><a href="/docs/database/schema/">Database Schema</a>:</strong> Data security implementation</li>
</ul>

          </div>

          
          <nav class="flex justify-between items-center mt-16 pt-8 border-t border-[rgba(67,79,138,0.2)]">
            <div>
              
              <a href="http://localhost:1313/docs/authentication/token-management/" class="inline-flex flex-col items-start px-6 py-4 bg-[rgba(10,12,26,0.5)] border border-[rgba(67,79,138,0.2)] rounded-lg hover:bg-[rgba(130,170,255,0.05)] hover:border-[#82aaff] transition-all transform hover:-translate-y-1">
                <span class="text-xs text-[#8b9cc2] uppercase tracking-wider mb-1">Previous</span>
                <span class="text-[#d4dff3] font-medium">Token Management</span>
              </a>
              
            </div>
            <div>
              
              <a href="http://localhost:1313/docs/authentication/auth-flow/" class="inline-flex flex-col items-end px-6 py-4 bg-[rgba(10,12,26,0.5)] border border-[rgba(67,79,138,0.2)] rounded-lg hover:bg-[rgba(130,170,255,0.05)] hover:border-[#82aaff] transition-all transform hover:-translate-y-1">
                <span class="text-xs text-[#8b9cc2] uppercase tracking-wider mb-1">Next</span>
                <span class="text-[#d4dff3] font-medium">Authentication Flow</span>
              </a>
              
            </div>
          </nav>
        </article>

        
        <aside class="hidden xl:block w-80 p-8 sticky top-32 self-start max-h-[calc(100vh-8rem)] overflow-y-auto">
          <div class="bg-[rgba(10,12,26,0.3)] border border-[rgba(67,79,138,0.2)] rounded-lg p-6">
            <h3 class="flex items-center text-[#82aaff] font-medium mb-4">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
              </svg>
              On This Page
            </h3>
            <div id="table-of-contents" class="space-y-1">
              
            </div>
          </div>
        </aside>

      </div>
    </main>
  </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', function() {
  
  const mobileSidebarToggle = document.getElementById('mobile-sidebar-toggle');
  const mobileOverlay = document.getElementById('mobile-overlay');
  const sidebar = document.getElementById('docs-sidebar');

  function toggleMobileSidebar() {
    sidebar.classList.toggle('-translate-x-full');
    mobileOverlay.classList.toggle('hidden');
    document.body.classList.toggle('overflow-hidden');
  }

  mobileSidebarToggle.addEventListener('click', toggleMobileSidebar);
  mobileOverlay.addEventListener('click', toggleMobileSidebar);

  
  const navSectionToggles = document.querySelectorAll('.nav-section-toggle');
  
  navSectionToggles.forEach(toggle => {
    toggle.addEventListener('click', function() {
      const section = this.closest('.nav-section');
      const content = section.querySelector('.nav-section-content');
      const chevron = this.querySelector('.chevron');
      
      if (content.style.maxHeight === '0px' || content.style.maxHeight === '') {
        content.style.maxHeight = content.scrollHeight + 'px';
        chevron.style.transform = 'rotate(90deg)';
      } else {
        content.style.maxHeight = '0px';
        chevron.style.transform = 'rotate(0deg)';
      }
    });
  });

  
  const activeLink = document.querySelector('.nav-link.active');
  if (activeLink) {
    const section = activeLink.closest('.nav-section');
    if (section) {
      const content = section.querySelector('.nav-section-content');
      const chevron = section.querySelector('.chevron');
      content.style.maxHeight = content.scrollHeight + 'px';
      chevron.style.transform = 'rotate(90deg)';
    }
  }

  
  function generateTableOfContents() {
    const headings = document.querySelectorAll('article h2, article h3, article h4, article h5, article h6');
    const toc = document.getElementById('table-of-contents');
    
    if (headings.length === 0 || !toc) return;

    headings.forEach((heading, index) => {
      
      if (!heading.id) {
        heading.id = heading.textContent.toLowerCase().replace(/[^a-z0-9]/g, '-').replace(/-+/g, '-').replace(/^-|-$/g, '');
      }

      const link = document.createElement('a');
      link.href = '#' + heading.id;
      link.textContent = heading.textContent;
      link.className = 'block py-1.5 px-3 text-sm text-[#8b9cc2] hover:text-[#d4dff3] hover:bg-[rgba(130,170,255,0.05)] rounded transition-colors';
      
      
      const level = parseInt(heading.tagName.charAt(1));
      if (level > 2) {
        link.style.paddingLeft = `${(level - 2) * 16 + 12}px`;
        link.style.borderLeft = '1px solid rgba(67,79,138,0.2)';
      }

      toc.appendChild(link);
    });

    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        const id = entry.target.id;
        const link = toc.querySelector(`a[href="#${id}"]`);
        if (link) {
          if (entry.isIntersecting) {
            toc.querySelectorAll('a').forEach(l => l.classList.remove('!text-[#82aaff]', 'bg-[rgba(130,170,255,0.1)]', 'font-medium'));
            link.classList.add('!text-[#82aaff]', 'bg-[rgba(130,170,255,0.1)]', 'font-medium');
          }
        }
      });
    }, { rootMargin: '-100px 0px -80% 0px' });

    headings.forEach((heading) => {
      observer.observe(heading);
    });
  }

  generateTableOfContents();

  
  document.addEventListener('click', function(e) {
    if (e.target.matches('a[href^="#"]')) {
      e.preventDefault();
      const target = document.querySelector(e.target.getAttribute('href'));
      if (target) {
        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }
  });
});
</script>

    </main>

    <footer class="fade-in-section">
    <div class="container">
        <p>&copy; 2025 AI Code Terminal. A statement on developer sovereignty.</p>
    </div>
</footer>
    
<script>
    feather.replace();
</script>

    <script src="/js/docs.js"></script>

</body>
</html>